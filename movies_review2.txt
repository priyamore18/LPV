# -*- coding: utf-8 -*-
"""ass2.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1l4Xf10WCAaE-oa2ZsGYRopMskR0v1v1_
"""

import numpy as np

from keras.datasets import imdb

from keras.preprocessing.sequence import pad_sequences

from keras.models import Sequential

from keras.layers import Embedding,Bidirectional,LSTM,Dense

(x_train, y_train), (x_test, y_test) = imdb.load_data(num_words=10000)



"""xtain x_test are reviews  y_testand ytrain are reviews positive and negative"""

max_len = 250

x_train = pad_sequences(x_train, maxlen=max_len)
x_test = pad_sequences(x_test, maxlen=max_len)

model = Sequential()

model.add(Embedding(input_dim=10000, output_dim=128, input_length=max_len))

model.add(Bidirectional(LSTM(64, return_sequences=True)))
model.add(Bidirectional(LSTM(32)))
model.add(Dense(1, activation='sigmoid'))

model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])

history = model.fit(x_train, y_train, epochs=2, batch_size=128, validation_split=0.2)

loss, acc = model.evaluate(x_test, y_test, batch_size=128)
print(f'Test accuracy: {acc:.4f}, Test loss: {loss:.4f}')